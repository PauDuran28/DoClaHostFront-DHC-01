-- Generado por Oracle SQL Developer Data Modeler 4.1.3.901
--   en:        2022-05-05 22:27:37 CLT
--   sitio:      Oracle Database 11g
--   tipo:      Oracle Database 11g

CREATE USER HOSTALCLARITA IDENTIFIED BY dhc123456;
GRANT DBA TO HOSTALCLARITA;


CREATE TABLE ADMINISTRADOR
  (
    id_administrador   NUMBER (12) NOT NULL ,
    nombre             VARCHAR2 (30) NOT NULL ,
    apellido           VARCHAR2 (30) NOT NULL ,
    email              VARCHAR2 (30) NOT NULL ,
    id_usuario         NUMBER (10) NOT NULL ,
    USUARIO_ID_USUARIO NUMBER (11) NOT NULL
  )
  LOGGING ;
ALTER TABLE ADMINISTRADOR ADD CONSTRAINT Administrador_PK PRIMARY KEY ( id_administrador, id_usuario ) ;


CREATE TABLE CATEGORIA
  (
    id_categoria     NUMBER (10) NOT NULL ,
    nombre_categoria VARCHAR2 (30) NOT NULL
  )
  LOGGING ;
ALTER TABLE CATEGORIA ADD CONSTRAINT CATEGORIA_PK PRIMARY KEY ( id_categoria ) ;

 CREATE TABLE DETALLE_ORDENPEDIDO 
   (	
   CODIGO NUMBER(20) NOT NULL, 
	 DESCRIPCION VARCHAR2(30) NOT, 
	 CANTIDAD NUMBER(10) NOT, 
	 PRECIO NUMBER(10) NOT NULL, 
	 SUBTOTAL NUMBER(10) NOT NULL, 
	 ID_PEDIDO NUMBER(10) NOT NULL
)

CREATE TABLE EMPLEADO
  (
    id_empleado     NUMBER (11) NOT NULL ,
    nombre          VARCHAR2 (30) NOT NULL ,
    apellido        VARCHAR2 (30) NOT NULL ,
    fecha_contrato  DATE NOT NULL ,
    email           VARCHAR2 (30) NOT NULL ,
    id_usuario      VARCHAR2 (20) NOT NULL ,
    rut             VARCHAR2 (11) NOT NULL ,
    USER_ID_USUARIO NUMBER (11) NOT NULL
  )
  LOGGING ;
ALTER TABLE EMPLEADO ADD CONSTRAINT EMPLEADO_PK PRIMARY KEY ( id_empleado, rut ) ;


CREATE TABLE ESTADO_HABITACION
  (
    id_estado          NUMBER (10) NOT NULL ,
    descripcion_estado VARCHAR2 (30) NOT NULL
  )
  LOGGING ;
ALTER TABLE ESTADO_HABITACION ADD CONSTRAINT Estado_habitacion_PK PRIMARY KEY ( id_estado, descripcion_estado ) ;


CREATE TABLE MAESTRO_CLIENTE
  (
    RUT_EMPRESA        VARCHAR2 (11) NOT NULL ,
    RAZON_SOCIAL       VARCHAR2 (20) NOT NULL ,
    GIRO               VARCHAR2 (30) NOT NULL ,
    DIRECCION          VARCHAR2 (30) NOT NULL ,
    TELEFONO           NUMBER (10) NOT NULL ,
    ID_USUARIO         VARCHAR2 (10) NOT NULL ,
    PASS               VARCHAR2 (10) NOT NULL ,
    USUARIO_ID_USUARIO NUMBER (11) NOT NULL
  ) ;
ALTER TABLE MAESTRO_CLIENTE ADD CONSTRAINT MAESTRO_CLIENTE_PK PRIMARY KEY ( RUT_EMPRESA ) ;


CREATE TABLE MAESTRO_PROVEEDOR
  (
    RUT_EMPRESA        VARCHAR2 (11) NOT NULL ,
    RAZON_SOCIAL       VARCHAR2 (20) NOT NULL ,
    GIRO               VARCHAR2 (30) NOT NULL ,
    CONTACTO           VARCHAR2 (20) NOT NULL ,
    TELEFONO           NUMBER (10) NOT NULL ,
    USUARIO_ID_USUARIO NUMBER (11) NOT NULL
  ) ;
ALTER TABLE MAESTRO_PROVEEDOR ADD CONSTRAINT MAESTRO_PROVEEDOR_PK PRIMARY KEY ( RUT_EMPRESA ) ;


CREATE TABLE MENU
  (
    id_menu            NUMBER (10) NOT NULL ,
    descripcion        VARCHAR2 (30) NOT NULL ,
    RESERVA_ID_RESERVA NUMBER (3) NOT NULL
  )
  LOGGING ;
ALTER TABLE MENU ADD CONSTRAINT MENU_PK PRIMARY KEY ( id_menu ) ;


CREATE TABLE PAGO
  (
    ID_PAGO               NUMBER (30) NOT NULL ,
    rut_empresa           NUMBER (11) NOT NULL ,
    monto                 NUMBER (10) NOT NULL ,
    EMPLEADO_id_empleado  NUMBER (11) NOT NULL ,
    EMPLEADO_rut          VARCHAR2 (11) NOT NULL ,
    MAEST_CLI_RUT_EMPRESA VARCHAR2 (11) NOT NULL
  )
  LOGGING ;
ALTER TABLE PAGO ADD CONSTRAINT PAGO_PK PRIMARY KEY ( ID_PAGO ) ;


CREATE TABLE REGISTRO_FACTURA
  (
    RUT_EMPRESA                 VARCHAR2 (11) NOT NULL ,
    RAZON_SOCIAL                VARCHAR2 (20) NOT NULL ,
    GIRO                        VARCHAR2 (30) NOT NULL ,
    FECHA_EMISION               DATE NOT NULL ,
    NUM_FACTURA                 NUMBER (5) NOT NULL ,
    ID_PRODUCTO                 NUMBER (9) NOT NULL ,
    MAESTRO_CLIENTE_RUT_EMPRESA VARCHAR2 (11) NOT NULL
  ) ;


CREATE TABLE REGISTRO_HABITACION
  (
    DISPONIBILIDAD              VARCHAR2 (20) NOT NULL ,
    TIPO_CAMA                   VARCHAR2 (20) NOT NULL ,
    ACCESORIO                   VARCHAR2 (20) NOT NULL ,
    PRECIO                      NUMBER (10) NOT NULL ,
    TIPO_HABITACION             VARCHAR2 (20) NOT NULL ,
    REG_HUESPED_TIPO_HABITACION VARCHAR2 (20) NOT NULL ,
    Est_hab_id_estado           NUMBER (10) NOT NULL ,
    Est_hab_descr_estado        VARCHAR2 (30) NOT NULL
  ) ;
ALTER TABLE REGISTRO_HABITACION ADD CONSTRAINT REGISTRO_HABITACION_PK PRIMARY KEY ( TIPO_HABITACION ) ;


CREATE TABLE REGISTRO_HUESPED
  (
    TIPO_HABITACION             VARCHAR2 (20) NOT NULL ,
    CANT_PERSONAS               NUMBER (9) NOT NULL ,
    FECHA_LLEGADA               DATE NOT NULL ,
    FECHA_SALIDA                DATE NOT NULL ,
    CARACTERISTICA              VARCHAR2 (20) NOT NULL ,
    PRECIO                      NUMBER (10) NOT NULL ,
    MAESTRO_CLIENTE_RUT_EMPRESA VARCHAR2 (11) NOT NULL
  ) ;
ALTER TABLE REGISTRO_HUESPED ADD CONSTRAINT REGISTRO_HUESPED_PK PRIMARY KEY ( TIPO_HABITACION ) ;


CREATE TABLE REGISTRO_ORDENCOMPRA
  (
    RUT_EMPRESA                 VARCHAR2 (11) NOT NULL ,
    RUT_TRABAJADOR              VARCHAR2 (11) NOT NULL ,
    NOMBRE_HUESPED              VARCHAR2 (20) NOT NULL ,
    CONTACTO                    VARCHAR2 (20) NOT NULL ,
    MAESTRO_CLIENTE_RUT_EMPRESA VARCHAR2 (11) NOT NULL
  ) ;
ALTER TABLE REGISTRO_ORDENCOMPRA ADD CONSTRAINT REGISTRO_ORDENCOMPRA_PK PRIMARY KEY ( RUT_EMPRESA ) ;


CREATE TABLE REGISTRO_ORDENPEDIDO
  (
    NUM_PEDIDO               NUMBER (10) NOT NULL ,
    RUT_EMPRESA              VARCHAR2 (11) NOT NULL ,
    RAZON_SOCIAL             VARCHAR2 (20) NOT NULL ,
    ID_PRODUCTO              NUMBER (9) NOT NULL ,
    CANTIDAD                 NUMBER (10) NOT NULL ,
    PRECIO                   NUMBER (10) NOT NULL ,
    MAESTRO_PROV_RUT_EMPRESA VARCHAR2 (11) NOT NULL ,
    REG_PRODUCTO_ID_PRODUCTO NUMBER (9) NOT NULL ,
    EMPLEADO_id_empleado     NUMBER (11) NOT NULL ,
    EMPLEADO_rut             VARCHAR2 (11) NOT NULL
  ) ;


CREATE TABLE REGISTRO_PRODUCTO
  (
    ID_PRODUCTO            NUMBER (9) NOT NULL ,
    CODIGO	           NUMBER(15) NOT NULL,		
    NOMBRE_PRODUCTO        VARCHAR2 (20) NOT NULL ,
    FAMILIA                VARCHAR2 (10) NOT NULL ,
    FECHA_VENCIMIENTO      DATE NOT NULL ,
    TIPO_PRODUCTO          VARCHAR2 (20) NOT NULL ,
    PRECIO                 NUMBER (10) NOT NULL ,
    STOCK                  NUMBER (10) NOT NULL ,
    STOCK_CRITICO          NUMBER (10) NOT NULL 
  ) ;
ALTER TABLE REGISTRO_PRODUCTO ADD CONSTRAINT REGISTRO_PRODUCTO_PK PRIMARY KEY ( ID_PRODUCTO ) ;


CREATE TABLE RESERVA
  (
    ID_RESERVA                  NUMBER (3) NOT NULL ,
    FECHA_INICIO                DATE NOT NULL ,
    FECHA_SALIDA                DATE NOT NULL ,
    CANT_PERSONAS               NUMBER (9) NOT NULL ,
    TIPO_HABITACION             VARCHAR2 (20) NOT NULL ,
    REG_HUESPED_TIPO_HABITACION VARCHAR2 (20) NOT NULL ,
    MAESTRO_CLIENTE_RUT_EMPRESA VARCHAR2 (11) NOT NULL
  ) ;
ALTER TABLE RESERVA ADD CONSTRAINT RESERVA_PK PRIMARY KEY ( ID_RESERVA ) ;


CREATE TABLE ROLES
  (
    id_rol      NUMBER (12) NOT NULL ,
    nombre_rol  VARCHAR2 (20) NOT NULL ,
    descripcion VARCHAR2 (30)
  )
  LOGGING ;
ALTER TABLE ROLES ADD CONSTRAINT Roles_PK PRIMARY KEY ( id_rol, nombre_rol ) ;


CREATE TABLE USUARIO
  (
    ID_USUARIO            NUMBER (11) NOT NULL ,
    PASS                  VARCHAR2 (10) NOT NULL ,
    Roles_id_rol          NUMBER (12) NOT NULL ,
    Roles_nombre_rol      VARCHAR2 (20) NOT NULL ,
    EST_HABI_id_estado    NUMBER (10) NOT NULL ,
    EST_HABI_descr_estado VARCHAR2 (30) NOT NULL
  ) ;
ALTER TABLE USUARIO ADD CONSTRAINT USUARIO_PK PRIMARY KEY ( ID_USUARIO ) ;


ALTER TABLE ADMINISTRADOR ADD CONSTRAINT Administrador_USUARIO_FK FOREIGN KEY ( USUARIO_ID_USUARIO ) REFERENCES USUARIO ( ID_USUARIO ) NOT DEFERRABLE ;

ALTER TABLE EMPLEADO ADD CONSTRAINT EMPLEADO_USUARIO_FK FOREIGN KEY ( USER_ID_USUARIO ) REFERENCES USUARIO ( ID_USUARIO ) NOT DEFERRABLE ;

ALTER TABLE MAESTRO_PROVEEDOR ADD CONSTRAINT MAESTRO_PROVEEDOR_USUARIO_FK FOREIGN KEY ( USUARIO_ID_USUARIO ) REFERENCES USUARIO ( ID_USUARIO ) NOT DEFERRABLE ;

ALTER TABLE MAESTRO_CLIENTE ADD CONSTRAINT MAES_CLTE_USU_FK FOREIGN KEY ( USUARIO_ID_USUARIO ) REFERENCES USUARIO ( ID_USUARIO ) NOT DEFERRABLE ;

ALTER TABLE MENU ADD CONSTRAINT MENU_RESERVA_FK FOREIGN KEY ( RESERVA_ID_RESERVA ) REFERENCES RESERVA ( ID_RESERVA ) NOT DEFERRABLE ;

ALTER TABLE PAGO ADD CONSTRAINT PAGO_EMPLEADO_FK FOREIGN KEY ( EMPLEADO_id_empleado, EMPLEADO_rut ) REFERENCES EMPLEADO ( id_empleado, rut ) NOT DEFERRABLE ;

ALTER TABLE PAGO ADD CONSTRAINT PAGO_MAESTRO_CLIENTE_FK FOREIGN KEY ( MAEST_CLI_RUT_EMPRESA ) REFERENCES MAESTRO_CLIENTE ( RUT_EMPRESA ) NOT DEFERRABLE ;



ALTER TABLE REGISTRO_FACTURA ADD CONSTRAINT REG_FACT_MAESTRO_CLIENTE_FK FOREIGN KEY ( MAESTRO_CLIENTE_RUT_EMPRESA ) REFERENCES MAESTRO_CLIENTE ( RUT_EMPRESA ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_HABITACION ADD CONSTRAINT REG_HABI_Estado_habi_FK FOREIGN KEY ( Est_hab_id_estado, Est_hab_descr_estado ) REFERENCES ESTADO_HABITACION ( id_estado, descripcion_estado ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_HABITACION ADD CONSTRAINT REG_HABI_REG_HUES_FK FOREIGN KEY ( REG_HUESPED_TIPO_HABITACION ) REFERENCES REGISTRO_HUESPED ( TIPO_HABITACION ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_HUESPED ADD CONSTRAINT REG_HUES_MAEST_CTE_FK FOREIGN KEY ( MAESTRO_CLIENTE_RUT_EMPRESA ) REFERENCES MAESTRO_CLIENTE ( RUT_EMPRESA ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_ORDENCOMPRA ADD CONSTRAINT REG_OC_MAESTRO_CLIENTE_FK FOREIGN KEY ( MAESTRO_CLIENTE_RUT_EMPRESA ) REFERENCES MAESTRO_CLIENTE ( RUT_EMPRESA ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_ORDENPEDIDO ADD CONSTRAINT REG_OP_EMPLEADO_FK FOREIGN KEY ( EMPLEADO_id_empleado, EMPLEADO_rut ) REFERENCES EMPLEADO ( id_empleado, rut ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_ORDENPEDIDO ADD CONSTRAINT REG_OP_MAESTRO_PROVEEDOR_FK FOREIGN KEY ( MAESTRO_PROV_RUT_EMPRESA ) REFERENCES MAESTRO_PROVEEDOR ( RUT_EMPRESA ) NOT DEFERRABLE ;

ALTER TABLE REGISTRO_ORDENPEDIDO ADD CONSTRAINT REG_OP_REG_PRODUCTO_FK FOREIGN KEY ( REG_PRODUCTO_ID_PRODUCTO ) REFERENCES REGISTRO_PRODUCTO ( ID_PRODUCTO ) NOT DEFERRABLE ;

ALTER TABLE RESERVA ADD CONSTRAINT RESERVA_MAESTRO_CLIENTE_FK FOREIGN KEY ( MAESTRO_CLIENTE_RUT_EMPRESA ) REFERENCES MAESTRO_CLIENTE ( RUT_EMPRESA ) NOT DEFERRABLE ;

ALTER TABLE RESERVA ADD CONSTRAINT RESERVA_REG_HUESPED_FK FOREIGN KEY ( REG_HUESPED_TIPO_HABITACION ) REFERENCES REGISTRO_HUESPED ( TIPO_HABITACION ) NOT DEFERRABLE ;

ALTER TABLE USUARIO ADD CONSTRAINT USUARIO_ESTADO_HABITACION_FK FOREIGN KEY ( EST_HABI_id_estado, EST_HABI_descr_estado ) REFERENCES ESTADO_HABITACION ( id_estado, descripcion_estado ) NOT DEFERRABLE ;

ALTER TABLE USUARIO ADD CONSTRAINT USUARIO_Roles_FK FOREIGN KEY ( Roles_id_rol, Roles_nombre_rol ) REFERENCES ROLES ( id_rol, nombre_rol ) NOT DEFERRABLE ;


INSERT INTO REGISTRO_PRODUCTO VALUES ('1','123456789','MANZANA','MANZANA12',to_date('31/05/22','DD/MM/YYYY'),'frutas_y_verduras','250','23','3' );
INSERT INTO REGISTRO_PRODUCTO VALUES ('2','987654321','PERA','PERA321',to_date('31/05/22','DD/MM/YYYY'),'frutas_y_verduras','200','20','3');


INSERT INTO CATEGORIA VALUES (1, 'frutas_y_verduras');

Insert into DETALLE_ORDENPEDIDO values ('12345789','MANZANA12','2','250','500','1');
Insert into DETALLE_ORDENPEDIDO values ('987654321','PERA321','2','200','400','1');

Insert into REGISTRO_ORDENPEDIDO ( values ('1','19','PRUEBA',to_date('25/05/22','DD/MM/YYYY'),'900')

-- Informe de Resumen de Oracle SQL Developer Data Modeler: 
-- 
-- CREATE TABLE                            17
-- CREATE INDEX                             0
-- ALTER TABLE                             35
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
